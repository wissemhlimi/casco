(this["webpackJsonpapp-frontend"]=this["webpackJsonpapp-frontend"]||[]).push([[82],{1293:function(e,t,n){"use strict";n.r(t);var a=n(11),r=n(2),i=n.n(r),o=n(45),c=n(37),u=n(3),s=n(252),l=n(5),d=function(e){return e.planning.view},m=Object(l.a)([d],(function(e){return e.record})),b={selectLoading:Object(l.a)([d],(function(e){return Boolean(e.loading)})),selectRecord:m,selectRaw:d},j=n(0),p=n(1),f=n.n(p),O=n(4),x=n(198),h=n(657),g=n(806),y=n(807),v=n(1275),w=(n(1223),n(1224),n(971)),q=n(1245),T=n(85),k=n(46),C=n(641),P=n(646),S=n(622),F=n(749),G=function(e){var t,n=window.location.pathname.split("planning/").pop(),r=function(){var a=Object(O.a)(f.a.mark((function a(r){var i,o;return f.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(!(r.length>0)){a.next=7;break}return a.next=3,T.a.find(n);case 3:(t=a.sent).product.map((function(t,n){t._id===e.data.data._id&&(i=n,t.perWeek.map((function(e,t){e._id===r[0].key._id&&(o=t)})))})),t.product[i].perWeek[o].quantityToProduce=r[0].data.quantityToProduce,T.a.update(t.id,t);case 7:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}(),o=e.data.data.perWeek;return Object(a.jsx)(i.a.Fragment,{children:Object(a.jsxs)(w.DataGrid,{dataSource:o,showBorders:!0,columnAutoWidth:!0,children:[Object(a.jsx)(w.Editing,{allowUpdating:!0,allowAdding:!1,allowDeleting:!1,mode:"form",onChangesChange:function(e){return r(e)}}),Object(a.jsx)(w.Column,{dataField:"week",allowEditing:!1}),Object(a.jsx)(w.Column,{dataField:"quantity",allowEditing:!1}),Object(a.jsx)(w.Column,{dataField:"quantityToProduce"})]})})},I=k.e().shape({quantity:C.a.integer(Object(u.d)("entities.planning.fields.quantity"),{required:!1}),subassembly:C.a.boolean(Object(u.d)("entities.planning.fields.subassembly"),{})}),D=function(e){var t=Object(r.useState)(!1),n=Object(x.a)(t,2),i=(n[0],n[1],Object(r.useState)(!1)),o=Object(x.a)(i,2),c=(o[0],o[1],Object(r.useState)({title:"",text:"",week:"",productId:"",subassembly:!1,finishGood:!1})),s=Object(x.a)(c,2),l=s[0],d=(s[1],Object(r.useState)({product:[]})),m=Object(x.a)(d,2),b=(m[0],m[1]),p=Object(r.useState)((function(){return{quantity:l.text,subassembly:l.subassembly,finishGood:l.finishGood}})),k=Object(x.a)(p,1)[0],C=e.record,D=e.loading,E=(Object(S.c)({resolver:Object(P.yupResolver)(I),mode:"all",defaultValues:k}),Object(r.useState)([{id:1,product:"",week:"",amountToProduce:0,perWeekRequested:0,perWeekToProduce:0,quantityInStock:0,subassembly:!0,finishGood:!0}])),R=Object(x.a)(E,2),W=R[0],Y=R[1],B=[{id:1,product:"",week:"",amountToProduce:0,perWeekRequested:0,perWeekToProduce:0,quantityInStock:0,subassembly:!0,finishGood:!0}],M=function(){var t=e.record?e.record.id:C.id;T.a.find(t).then((function(e){b(e),e.product.map((function(e,t){e.perWeek.map((function(n){var a={id:t,product:e.id,amountToProduce:e.quantityToProduce,week:n.week,perWeekRequested:n.quantity,perWeekToProduce:n.quantityToProduce,quantityInStock:e.quantityInStock,subassembly:e.subassembly,finishGood:e.finishGood};B.push(a)}))}))})),B.shift(),Y(B)};Object(r.useEffect)((function(){!D&&C&&M()}),[!D&&C]);var A=function(){var t=Object(O.a)(f.a.mark((function t(n){var a;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n.length>0&&(e.record.product.map((function(e,t){e._id===n[0].key._id&&(a=t)})),e.record.product[a].subassembly=void 0===n[0].data.subassembly?n[0].key.subassembly:n[0].data.subassembly,e.record.product[a].finishGood=void 0===n[0].data.finishGood?n[0].key.finishGood:n[0].data.finishGood,T.a.update(e.record.id,e.record));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();new q.a({fields:[{caption:"Product",width:250,dataField:"product",area:"row",selector:e=>"".concat(e.product," Quantity in stock: ").concat(e.quantityInStock)},{caption:"Quantity Requested",dataField:"amountToProduce",width:300,area:"row",selector:e=>"\n            Quantity To Produce: ".concat(e.amountToProduce,"\n\n            ").concat(e.subassembly?"SubAssembly: true":"SubAssembly: false","\n            ").concat(e.finishGood?"Finish Goods: true":"Finish Goods: false","\n          ")},{dataField:"week",dataType:"string",area:"column"},{caption:"Requested",dataField:"perWeekRequested",dataType:"number",summaryType:"sum",area:"data"},{caption:"ToProduce",dataField:"perWeekToProduce",dataType:"number",summaryType:"sum",area:"data"}],store:W});return D||!C?Object(a.jsx)(h.a,{}):Object(a.jsxs)(F.a,{children:[Object(a.jsxs)(g.a,{gutter:24,children:[Boolean(C.name)&&Object(a.jsx)(y.a,{span:6,children:Object(a.jsx)(v.a.Item,Object(j.a)(Object(j.a)({},F.b),{},{label:Object(u.d)("entities.planning.fields.name"),children:C.name}))}),Boolean(C.year)&&Object(a.jsx)(y.a,{span:6,children:Object(a.jsx)(v.a.Item,Object(j.a)(Object(j.a)({},F.b),{},{label:Object(u.d)("entities.planning.fields.year"),children:C.year}))}),Boolean(C.week)&&Object(a.jsx)(y.a,{span:6,children:Object(a.jsx)(v.a.Item,Object(j.a)(Object(j.a)({},F.b),{},{label:Object(u.d)("entities.planning.fields.week"),children:C.week}))}),Boolean(C.status)&&Object(a.jsx)(y.a,{span:6,children:Object(a.jsx)(v.a.Item,Object(j.a)(Object(j.a)({},F.b),{},{label:Object(u.d)("entities.planning.fields.status"),children:Object(u.d)("entities.planning.enumerators.status.".concat(C.status))}))})]}),Object(a.jsxs)(w.DataGrid,{dataSource:C.product,allowColumnReordering:!0,children:[Object(a.jsx)(w.Selection,{mode:"multiple"}),Object(a.jsx)(w.GroupPanel,{visible:!1}),Object(a.jsx)(w.Grouping,{autoExpandAll:!0}),Object(a.jsx)(w.Editing,{allowUpdating:!0,allowAdding:!1,allowDeleting:!1,mode:"row",onChangesChange:function(e){return A(e)}}),Object(a.jsx)(w.Column,{dataField:"id",allowEditing:!1}),Object(a.jsx)(w.Column,{dataField:"quantityInStock",allowEditing:!1}),Object(a.jsx)(w.Column,{dataField:"quantityToProduce",allowEditing:!1}),Object(a.jsx)(w.Column,{dataField:"quantityRequested",allowEditing:!1}),Object(a.jsx)(w.Column,{dataField:"subassembly",dataType:"boolean"}),Object(a.jsx)(w.Column,{dataField:"finishGood",dataType:"boolean"}),Object(a.jsx)(w.MasterDetail,{enabled:!0,component:G}),Object(a.jsx)(w.Paging,{defaultPageSize:10}),Object(a.jsx)(w.Pager,{visible:!0,allowedPageSizes:!0,displayMode:"compact",showPageSizeSelector:!0,showInfo:!0,showNavigationButtons:!0}),Object(a.jsx)(w.Export,{enabled:!0,allowExportSelectedData:!0})]})]})},E=n(852),R=n(693),W=n(612),Y=n(212),B=n(692),M=n(106),A=n(142),U=n(894),_=n(176),L=n(918),z=n(638),Q=function(e){var t=Object(o.d)(),n=Object(c.h)(),r=Object(o.e)(A.a.selectPermissionToRead),i=Object(o.e)(U.a.selectPermissionToEdit),s=Object(o.e)(U.a.selectPermissionToDestroy),l=Object(o.e)(L.a.selectLoading),d=n.params.id;return Object(a.jsxs)(z.a,{children:[i&&Object(a.jsx)(M.a,{to:"/planning/".concat(d,"/edit"),children:Object(a.jsx)(Y.a,{type:"primary",icon:Object(a.jsx)(E.a,{}),children:Object(u.d)("common.edit")})}),s&&Object(a.jsx)(B.a,{title:Object(u.d)("common.areYouSure"),onConfirm:function(){t(_.a.doDestroy(d))},okText:Object(u.d)("common.yes"),cancelText:Object(u.d)("common.no"),children:Object(a.jsx)(Y.a,{type:"primary",icon:Object(a.jsx)(R.a,{}),disabled:l,children:Object(u.d)("common.destroy")})}),r&&Object(a.jsx)(M.a,{to:"/audit-logs?entityId=".concat(encodeURIComponent(d)),children:Object(a.jsx)(Y.a,{icon:Object(a.jsx)(W.a,{}),children:Object(u.d)("auditLog.menu")})})]})},H=n(627),J=n(629),V=n(628);t.default=function(e){var t=Object(o.d)(),n=Object(c.h)(),i=Object(o.e)(b.selectLoading),l=Object(o.e)(b.selectRecord);return Object(r.useEffect)((function(){t(s.a.doFind(n.params.id))}),[]),Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(J.a,{items:[[Object(u.d)("dashboard.menu"),"/"],[Object(u.d)("entities.planning.menu"),"/planning"],[Object(u.d)("entities.planning.view.title")]]}),Object(a.jsxs)(H.a,{children:[Object(a.jsxs)(g.a,{children:[Object(a.jsx)(y.a,{span:16,children:Object(a.jsx)(V.a,{children:Object(u.d)("entities.planning.view.title")})}),Object(a.jsx)(y.a,{span:8,style:{textAlign:"end"},children:Object(a.jsx)(Q,{match:n})})]}),Object(a.jsx)(D,{loading:i,record:l})]})]})}},627:function(e,t,n){"use strict";var a=n(182);function r(){var e=Object(a.a)(["\n  margin: 0px;\n  margin-top: 16px;\n  padding: 24px;\n  border-radius: 5px;\n  background: #fff;\n  border: 1px solid #e9e9e9;\n  overflow-y: hidden;\n"]);return r=function(){return e},e}var i=n(183).a.div(r());t.a=i},628:function(e,t,n){"use strict";var a=n(182);function r(){var e=Object(a.a)(["\n  margin-bottom: 36px;\n"]);return r=function(){return e},e}var i=n(183).a.h1(r());t.a=i},629:function(e,t,n){"use strict";var a=n(11),r=n(670),i=(n(2),n(106));t.a=function(e){var t=function(e){return e.length>1};return Object(a.jsx)(r.a,{children:e.items.map((function(e){return Object(a.jsx)(r.a.Item,{children:t(e)?Object(a.jsx)(i.a,{to:e[1],children:e[0]}):e[0]},e[0])}))})}},638:function(e,t,n){"use strict";var a=n(182);function r(){var e=Object(a.a)(["\n  margin-bottom: 16px;\n\n  .ant-btn {\n    margin-right: 8px;\n    margin-bottom: 8px;\n  }\n"]);return r=function(){return e},e}var i=n(183).a.div(r());t.a=i},641:function(e,t,n){"use strict";var a=n(52),r=n(46),i=n(3),o=n(108),c=n.n(o),u={generic:e=>r.c().label(e),string(e,t){t=t||{};var n=r.h().transform((function(e,t){return""===t?null:e})).nullable(!0).trim().label(e);return t.required&&(n=n.required()),(t.min||0===t.min)&&(n=n.min(t.min)),t.max&&(n=n.max(t.max)),t.matches&&(n=n.matches(t.matches)),n},boolean:(e,t)=>r.b().default(!1).label(e),relationToOne(e,t){t=t||{};var n=r.c().nullable(!0).label(e).transform((function(e,t){return t?t.id:null}));return t.required&&(n=n.required()),n},stringArray(e,t){t=t||{};var n=r.a().compact().ensure().of(r.h().transform((function(e,t){return""===t?null:e})).trim()).label(e);return t.required&&(n=n.required()),t.min||0===t.min?n=n.min(t.min):t.required&&(n=n.min(1)),t.max&&(n=n.max(t.max)),n},relationToMany(e,t){t=t||{};var n=r.a().nullable(!0).label(e).transform((function(e,t){return t&&t.length?t.map((function(e){return e.id})):[]}));return t.required&&(n=n.required()),t.min||0===t.min?n=n.min(t.min):t.required&&(n=n.min(1)),t.max&&(n=n.max(t.max)),n},integer(e,t){t=t||{};var n=r.d().transform((function(e,t){return""===t?null:e})).integer().nullable(!0).label(e);return t.required&&(n=n.required()),(t.min||0===t.min)&&(n=n.min(t.min)),t.max&&(n=n.max(t.max)),n},images(e,t){t=t||{};var n=r.a().nullable(!0).label(e);return(t.required||t.min)&&(n=n.required()),t.min||0===t.min?n=n.min(t.min):t.required&&(n=n.min(1)),t.max&&(n=n.max(t.max)),n},files(e,t){t=t||{};var n=r.a().compact().ensure().nullable(!0).label(e);return(t.required||t.min)&&(n=n.required()),t.min||0===t.min?n=n.min(t.min):t.required&&(n=n.min(1)),t.max&&(n=n.max(t.max)),n},enumerator(e,t){t=t||{};var n=r.h().transform((function(e,t){return""===t?null:e})).label(e).nullable(!0).oneOf([null].concat(Object(a.a)(t.options||[])));return t.required&&(n=n.required(Object(i.d)("validation.string.selected"))),n},email(e,t){t=t||{};var n=r.h().transform((function(e,t){return""===t?null:e})).nullable(!0).trim().label(e).email();return t.required&&(n=n.required()),(t.min||0===t.min)&&(n=n.min(t.min)),t.max&&(n=n.max(t.max)),t.matches&&(n=n.matches(t.matches)),n},decimal(e,t){t=t||{};var n=r.d().transform((function(e,t){return""===t?null:e})).nullable(!0).label(e);return t.required&&(n=n.required()),(t.min||0===t.min)&&(n=n.min(t.min)),t.max&&(n=n.max(t.max)),n},datetime(e,t){t=t||{};var n=r.c().nullable(!0).label(e).transform((function(e,t){return e?c()(t,"YYYY-MM-DD HH:mm").toISOString():null}));return t.required&&(n=n.required()),n},date(e,t){t=t||{};var n=r.c().nullable(!0).label(e).test("is-date",Object(i.d)("validation.mixed.default"),(function(e){return!e||c()(e,"YYYY-MM-DD").isValid()})).transform((function(e){return e?c()(e).format("YYYY-MM-DD"):null}));return t.required&&(n=n.required()),n}};t.a=u},657:function(e,t,n){"use strict";var a=n(11),r=n(658);n(2);t.a=function(e){return Object(a.jsx)("div",{style:{width:"100%",marginTop:"24px",marginBottom:"24px",display:"flex",justifyContent:"center",alignContent:"center",alignItems:"center"},children:Object(a.jsx)(r.a,{})})}},749:function(e,t,n){"use strict";n.d(t,"b",(function(){return o}));var a=n(182);function r(){var e=Object(a.a)(["\n  padding: 24px;\n  padding-top: 0;\n  padding-bottom: 0;\n\n  .ant-form-item-label {\n    white-space: normal;\n  }\n\n  .ant-row {\n    margin-bottom: 8px;\n  }\n"]);return r=function(){return e},e}var i=n(183).a.div(r()),o={labelCol:{md:{span:6},lg:{span:4}},wrapperCol:{md:{span:18},lg:{span:12}}};t.a=i},894:function(e,t,n){"use strict";var a=n(5),r=n(42),i=n(76),o=n(184),c=Object(a.a)([r.a.selectCurrentTenant,r.a.selectCurrentUser],(function(e,t){return new i.a(e,t).match(o.a.values.planningRead)})),u=Object(a.a)([r.a.selectCurrentTenant,r.a.selectCurrentUser],(function(e,t){return new i.a(e,t).match(o.a.values.planningEdit)})),s=Object(a.a)([r.a.selectCurrentTenant,r.a.selectCurrentUser],(function(e,t){return new i.a(e,t).match(o.a.values.planningCreate)})),l=Object(a.a)([r.a.selectCurrentTenant,r.a.selectCurrentUser],(function(e,t){return new i.a(e,t).match(o.a.values.planningImport)})),d={selectPermissionToRead:c,selectPermissionToEdit:u,selectPermissionToCreate:s,selectPermissionToDestroy:Object(a.a)([r.a.selectCurrentTenant,r.a.selectCurrentUser],(function(e,t){return new i.a(e,t).match(o.a.values.planningDestroy)})),selectPermissionToImport:l};t.a=d},918:function(e,t,n){"use strict";var a=n(5),r={selectLoading:Object(a.a)([function(e){return e.planning.destroy}],(function(e){return Boolean(e.loading)}))};t.a=r}}]);